<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kenyan Salary & Expense Calculator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: #F4F4F4;
        color: #333;
    }
    .container {
        max-width: 700px;
        margin: 50px auto;
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }
    h2, h3 {
        text-align: center;
        color: #124E66;
    }
    label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
    }
    input[type="number"] {
        width: 100%;
        padding: 8px;
        margin: 5px 0 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }
    th, td {
        padding: 10px;
        border: 1px solid #ddd;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background: #124E66;
        color: white;
    }
    .btn-container {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
    }
    .btn {
        flex: 1;
        padding: 12px;
        margin: 5px;
        cursor: pointer;
        background: #124E66;
        color: white;
        border: none;
        border-radius: 5px;
        text-align: center;
        font-size: 16px;
    }
    .btn:hover {
        background: #2E3944;
    }
</style>
</head>
<body>
<div class="container">
    <h2>My Expense Tracker</h2>
    <label>Gross Salary (KES): </label>
    <input type="number" id="grossSalary" oninput="calculateNetPay()" />

    <h3>Deductions</h3>
    <p><strong>NSSF:</strong> <span id="nssf">0</span></p>
    <p><strong>SHIF:</strong> <span id="shif">0</span></p>
    <p><strong>AHL:</strong> <span id="ahl">0</span></p>
    <p><strong>Pension Contribution:</strong> <span id="pension">0</span></p>
    <p><strong>PAYE:</strong> <span id="paye">0</span></p>
    <h3>Net Salary: KES <span id="netSalary">0</span></h3>

    <h3>Expenses</h3>
    <table id="expenseTable">
        <tr>
            <th>Expense</th>
            <th>Amount (KES)</th>
        </tr>
<tr><td>Rent/Mortgage</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Food/Groceries</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Medical Expenses</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Transport/Fuel</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Education/School Fees</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Tithes/offerings</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Clothings</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Welfare</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Internet</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Electricity</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
<tr><td>Other Expenses</td><td><input type="number" class="expense" oninput="calculateBalance()"></td></tr>
    </table>
    
    <div class="btn-container">
        <button class="btn" onclick="addExpense()">Add Expense</button>
        <button class="btn" onclick="exportToExcel()">Export to Excel</button>
        <button class="btn" onclick="exportToPDF()">Export to PDF</button>
    </div>
    
    <h3>Remaining Balance: KES <span id="balance">0</span></h3>
</div>
<script>
    function calculateNetPay() {
        let gross = parseFloat(document.getElementById('grossSalary').value) || 0;
       
        let nssf = Math.min(0.06 * (gross > 72000 ? 72000 : gross), 8640);
        let shif = Math.max(gross * 0.0275, 300);
        let ahl = gross * 0.015;
        let pension = gross * 0.05;
       
        let taxableIncome = gross - nssf - ahl - pension;
       
        let paye = 0;
        if (taxableIncome > 800000) {
            paye += (taxableIncome - 800000) * 0.35;
            taxableIncome = 800000;
        }
        if (taxableIncome > 500000) {
            paye += (taxableIncome - 500000) * 0.325;
            taxableIncome = 500000;
        }
        if (taxableIncome > 46767) {
            paye += (taxableIncome - 46767) * 0.30;
            taxableIncome = 46767;
        }
        if (taxableIncome > 32333) {
            paye += (taxableIncome - 32333) * 0.25;
            taxableIncome = 32333;
        }
        if (taxableIncome > 24000) {
            paye += (taxableIncome - 24000) * 0.10;
        }
       
        let net = gross - (nssf + shif + ahl + pension + paye);
       
        document.getElementById('nssf').textContent = nssf.toFixed(2);
        document.getElementById('shif').textContent = shif.toFixed(2);
        document.getElementById('ahl').textContent = ahl.toFixed(2);
        document.getElementById('pension').textContent = pension.toFixed(2);
        document.getElementById('paye').textContent = paye.toFixed(2);
        document.getElementById('netSalary').textContent = net.toFixed(2);
        calculateBalance();
    }
 
    function calculateBalance() {
        let netSalary = parseFloat(document.getElementById('netSalary').textContent) || 0;
        let totalExpenses = Array.from(document.getElementsByClassName('expense'))
            .reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
        let balance = netSalary - totalExpenses;
        document.getElementById('balance').textContent = balance.toFixed(2);
    }
 
    function addExpense() {
        let table = document.getElementById('expenseTable');
        let row = table.insertRow();
        let cell1 = row.insertCell(0);
        let cell2 = row.insertCell(1);
        let expenseName = prompt("Enter expense name:");
        if (expenseName) {
            cell1.textContent = expenseName;
            cell2.innerHTML = '<input type="number" class="expense" oninput="calculateBalance()">';
        }
        calculateBalance();
    }
</script>
</body>
</html>
<script>
function exportToExcel() {
    // Create a new workbook and worksheet
    let wb = XLSX.utils.book_new();
    
    // Gross Salary
    let grossSalary = document.getElementById("grossSalary").value || "0";
    let data = [["Kenyan Salary & Expense Report"], [], ["Gross Salary", "KES " + grossSalary], []];

    // Deductions Table
    data.push(["Deductions"]);
    data.push(["Deduction", "Amount (KES)"]);
    let deductions = [
        ["NSSF", document.getElementById('nssf')?.textContent.trim() || "0"],
        ["SHIF", document.getElementById('shif')?.textContent.trim() || "0"],
        ["AHL", document.getElementById('ahl')?.textContent.trim() || "0"],
        ["Pension", document.getElementById('pension')?.textContent.trim() || "0"],
        ["PAYE", document.getElementById('paye')?.textContent.trim() || "0"]
    ];
    data = data.concat(deductions);
    data.push([]);

    // Net Salary
    let netSalary = document.getElementById("netSalary")?.textContent.trim() || "0";
    data.push(["Net Salary", "KES " + netSalary]);
    data.push([]);

    // Expenses Table
    data.push(["Expenses"]);
    data.push(["Expense", "Amount (KES)"]);
    let rows = document.querySelectorAll("#expenseTable tbody tr");
    rows.forEach(row => {
        let expenseName = row.cells[0].textContent.trim();
        let expenseAmount = row.cells[1].querySelector("input")?.value.trim() || "0";
        data.push([expenseName, expenseAmount]);
    });
    data.push([]);

    // Remaining Balance
    let balance = document.getElementById("balance")?.textContent.trim() || "0";
    data.push(["Remaining Balance", "KES " + balance]);

    // Convert data to a worksheet and append to workbook
    let ws = XLSX.utils.aoa_to_sheet(data);
    XLSX.utils.book_append_sheet(wb, ws, "Salary Report");

    // Export the workbook to Excel file
    XLSX.writeFile(wb, "Salary_Expense_Report.xlsx");
}
</script>

<!-- Add this button to your HTML -->
<button id="exportPDF">Export to PDF</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    document.getElementById("exportPDF").addEventListener("click", exportToPDF);
});

function exportToPDF() {
    const { jsPDF } = window.jspdf;
    let doc = new jsPDF();

    // Title
    doc.setFont("helvetica", "bold");
    doc.setFontSize(16);
    doc.text("Kenyan Salary & Expense Report", 60, 15);

    // Gross Salary
    let grossSalary = document.getElementById("grossSalary").value || "0";
    doc.setFontSize(12);
    doc.setFont("helvetica", "normal");
    doc.text("Gross Salary: KES " + grossSalary, 14, 30);

    // Deductions Table
    let deductions = [
        ["NSSF", document.getElementById('nssf')?.textContent.trim() || "0"],
        ["SHIF", document.getElementById('shif')?.textContent.trim() || "0"],
        ["AHL", document.getElementById('ahl')?.textContent.trim() || "0"],
        ["Pension", document.getElementById('pension')?.textContent.trim() || "0"],
        ["PAYE", document.getElementById('paye')?.textContent.trim() || "0"]
    ];

    doc.setFont("helvetica", "bold");
    doc.text("Deductions", 14, 40);

    doc.autoTable({
        startY: 45,
        head: [["Deduction", "Amount (KES)"]],
        body: deductions,
        theme: "grid",
        styles: { fontSize: 10 }
    });

    // Net Salary
    let netSalary = document.getElementById("netSalary")?.textContent.trim() || "0";
    doc.setFont("helvetica", "bold");
    doc.text("Net Salary: KES " + netSalary, 14, doc.autoTable.previous.finalY + 10);

    // Expenses Table
    let expenses = [];
    let rows = document.querySelectorAll("#expenseTable tbody tr");

    rows.forEach((row) => {
        let expenseName = row.cells[0].textContent.trim();
        let expenseAmount = row.cells[1].querySelector("input")?.value.trim() || "0";
        expenses.push([expenseName, expenseAmount]);
    });

    doc.setFontSize(12);
    doc.text("Expenses", 14, doc.autoTable.previous.finalY + 20);

    doc.autoTable({
        startY: doc.autoTable.previous.finalY + 25,
        head: [["Expense", "Amount (KES)"]],
        body: expenses,
        theme: "grid",
        styles: { fontSize: 10 }
    });

    // Remaining Balance
    let balance = document.getElementById("balance")?.textContent.trim() || "0";
    doc.setFont("helvetica", "bold");
    doc.text("Remaining Balance: KES " + balance, 14, doc.autoTable.previous.finalY + 10);

    // Save PDF
    doc.save("Salary_Expense_Report.pdf");
}
</script>
